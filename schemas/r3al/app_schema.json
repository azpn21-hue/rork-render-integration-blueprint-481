{
  "screens": [
    {
      "id": "splash",
      "type": "SplashScreen",
      "properties": {
        "animation": "pulse",
        "duration": 1000,
        "bpm": 60
      },
      "next": "onboard_welcome"
    },
    {
      "id": "onboard_welcome",
      "type": "OnboardingScreen",
      "properties": {
        "phase": 1,
        "title": "welcome_title",
        "subtitle": "welcome_subtitle",
        "message": "welcome_message"
      },
      "next": "onboard_consent"
    },
    {
      "id": "onboard_consent",
      "type": "OnboardingScreen",
      "properties": {
        "phase": 2,
        "title": "consent_title",
        "message": "consent_message",
        "requiresConsent": true
      },
      "next": "id_verify_intro"
    },
    {
      "id": "id_verify_intro",
      "type": "VerificationIntroScreen",
      "properties": {
        "title": "verify_id_title",
        "instructions": "verify_id_instructions"
      },
      "next": "id_verification"
    },
    {
      "id": "id_verification",
      "type": "IdentityVerificationScreen",
      "properties": {
        "useBiometric": true,
        "useDocumentScan": true
      },
      "events": {
        "onVerified": "questionnaire"
      },
      "next": "questionnaire"
    },
    {
      "id": "questionnaire",
      "type": "QuestionnaireScreen",
      "properties": {
        "schema": "questionnaire_schema",
        "title": "questionnaire_title",
        "intro": "questionnaire_intro",
        "ui": {
          "optionalToggleKey": "show_optional_deep_disclosure",
          "showProgressBar": true,
          "perPage": 1,
          "allowBack": true,
          "saveAsYouGo": true,
          "accent": "#D4AF37",
          "accessibility": {
            "captions": true,
            "largerTapTargets": true
          }
        },
        "scoring": "./truthscore_schema.json"
      },
      "events": {
        "onSubmit": "calcTruthScore"
      },
      "next": "score_result"
    },
    {
      "id": "score_result",
      "type": "ScoreResultScreen",
      "properties": {
        "showDetails": true,
        "allowExpansion": true
      },
      "next": "profile_setup"
    },
    {
      "id": "truth_expansion",
      "type": "TruthExpansionScreen",
      "properties": {
        "showCharts": true,
        "showAnalysis": true
      }
    },
    {
      "id": "profile_setup",
      "type": "ProfileSetupScreen",
      "properties": {
        "title": "profile_title",
        "subtitle": "profile_subtitle",
        "required_fields": ["name"]
      },
      "next": "home"
    },
    {
      "id": "home",
      "type": "HomeScreen",
      "properties": {
        "title": "home_welcome"
      }
    },
    {
      "id": "messages",
      "type": "MessagingScreen",
      "properties": {}
    },
    {
      "id": "user_profile",
      "type": "UserProfileScreen",
      "properties": {}
    },
    {
      "id": "capture_history",
      "type": "HistoryScreen",
      "lockOrderIndex": 999,
      "properties": {
        "title": "Content Capture History",
        "description": "You'll see alerts here if someone attempted to screenshot or record your protected content. No personal data is ever stored or shared.",
        "icon": "shield-alert"
      },
      "components": [
        {
          "type": "List",
          "binding": "@state.captureHistory",
          "emptyState": {
            "icon": "shield-check",
            "text": "No capture alerts yet. Your content is fully protected."
          },
          "itemTemplate": {
            "title": "{{event_screen}}",
            "subtitle": "Attempt detected at {{timestamp_local}}",
            "meta": "Status: {{status}}"
          }
        },
        {
          "type": "ButtonRow",
          "buttons": [
            {
              "text": "Appeal Alert",
              "style": "secondary",
              "action": "openAppealForm(selectedItem)"
            },
            {
              "text": "Back",
              "style": "primary",
              "action": "go(settings_home)"
            }
          ]
        }
      ]
    },
    {
      "id": "appeal_form",
      "type": "FormScreen",
      "properties": {
        "title": "Appeal Capture Alert",
        "description": "Explain why you believe this capture alert was triggered in error. Our moderation team reviews every request."
      },
      "components": [
        {
          "type": "TextField",
          "id": "subject",
          "label": "Subject",
          "required": true
        },
        {
          "type": "TextArea",
          "id": "details",
          "label": "Explanation",
          "required": true,
          "maxLength": 1000
        },
        {
          "type": "ButtonRow",
          "buttons": [
            {
              "text": "Cancel",
              "style": "secondary",
              "action": "go(capture_history)"
            },
            {
              "text": "Submit",
              "style": "primary",
              "action": "submitAppeal()"
            }
          ]
        }
      ]
    }
  ],
  "navigation": {
    "stack": ["home", "messages", "user_profile", "capture_history", "appeal_form"],
    "modal": ["truth_expansion"]
  }
}
